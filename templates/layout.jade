include lib
!!! true
html
  head
    meta(http-equiv='Content-Type', content='text/html; charset=utf-8')
    title #{title} #{version} API documentation | Home
    meta(name='generator', content='ndoc')
    script(charset='utf-8', src='javascripts/jquery-1.7.min.js', type='text/javascript')
    script(charset='utf-8', src='javascripts/jquery.textchange.js', type='text/javascript')
    script(charset='utf-8', type='text/javascript')
      $(document)
      // TODO: textchange?
      .delegate('#search', 'keyup', function() {
        //console.log('CH', arguments);
        var filter = $(this).val();
        // TODO: glob-style search?
        var re = new RegExp(filter, 'i');
        var count = 0;
        $('div.article').addClass('hidden');
        $('div.article').each(function() {
          if (~$(this).attr('id').search(re)) {
            $(this).removeClass('hidden');
            ++count;
          }
        });
        $('div#home')[filter ? 'addClass' : 'removeClass']('hidden');
        $('div.menu-item').addClass('hidden');
        $('div.menu-item >a').each(function() {
          if (~$(this).attr('href').substring(1).search(re)) {
            $(this).parents('div.menu-item').removeClass('hidden');
          }
        });
      })
      .delegate('div.menu-item >a', 'click', function() {
        $('div.article').hide();
        $('div.article[id="' + $(this).attr('href').substring(1) + '"]').show();
      });
    link(charset='utf-8', href='stylesheets/api.css', media='screen, projection', rel='stylesheet', type='text/css')
    link(charset='utf-8', href='stylesheets/syntax.css', media='screen, projection', rel='stylesheet', type='text/css')
    style
      .hidden { display: none !important;}
  body
    #sidebar
      ul#sidebar_tabs.sidebar-tabs
        li
          a(href='#menu_pane') Menu
        li
          a(href='#search_pane') Search
      form.search-ribbon
        label
          span.hidden Search
          input#search(type='text', size='20', title='Search')
      #menu_pane.sidebar-pane.scrollable
        ul#api_menu.menu-items
          mixin menu(tree)
      //-
        #search_pane.sidebar-pane
          ul#search_results.search-results.menu-items.scrollable
    #page
      #main.page-content

        #home.page-introduction!= hilite(htmlize(readme), false, true)

        mixin api(tree)

        if sections.length
          .section.section-sections
            .section-title
              h3 Sections
            .section-content
              ul.section-list
                for section in sections
                  li
                    h4
                      a(href="#{path_to(section)") #{section.name}
                    p= section.short_description

      #footer
        p
          a(href=src_code_href||'') #{title}
          |  #{version} API documentation.
        p
          | Last updated on #{(new Date).toUTCString()}
          | Generated by
          a(href='http://github.com/dvv/ndoc') ndoc
          | .
          | Uses
          a(href='http://famfamfam.com/lab/icons/silk/', title='famfamfam.com: Silk Icons') Silk Icons
          |  and portions of
          a(href='http://github.com/280north/aristo/tree/master', title='280north\'s aristo at master - GitHub') Aristo
          | .
